# 필터링 조건 1 (최소 지속시간) 제거 개수가 동일한 이유

## 문제점

충전과 방전의 필터링 조건 1은 다릅니다:
- **충전**: < 10.0초
- **방전**: < 30.0초

하지만 제거 개수가 동일하게 10,185개로 표시됩니다.

## 원인: 코드의 통계 집계 방식

### 코드 구조 분석

1. **통계 저장 구조** (라인 357-365):
```matlab
filterStats.(channelName).(soc_level).(profile_name).rejected_short_duration = 0;
```
- 충전/방전 구분 없이 **하나의 변수**에 저장

2. **필터링 적용** (라인 438-441):
```matlab
if driving_time < min_duration
    rejected_short_duration = rejected_short_duration + 1;
    filterStats.(channelName).(soc_level).(profile_name).rejected_short_duration = ...
        filterStats.(channelName).(soc_level).(profile_name).rejected_short_duration + 1;
```
- 충전이면 `min_duration_chg` (10초) 기준
- 방전이면 `min_duration_dchg` (30초) 기준
- 하지만 **같은 변수**에 누적

3. **통계 집계** (라인 1521):
```matlab
totalRejectedShortDuration = totalRejectedShortDuration + stats.rejected_short_duration;
```
- 충전/방전 구분 없이 **하나의 총합**으로 집계

4. **출력** (라인 1590, 1676):
```matlab
% 충전 이벤트 필터링 조건표 (라인 1590)
step1_rejected = totalRejectedShortDuration;

% 방전 이벤트 필터링 조건표 (라인 1676)
step1_rejected = totalRejectedShortDuration;  % 같은 값 사용!
```

## 결론

**제거 개수가 동일하게 보이는 이유**:
- 코드가 충전/방전 구분 없이 통계를 하나로 집계
- 출력할 때도 같은 `totalRejectedShortDuration` 값을 사용
- 실제로는 충전/방전 각각 다른 개수가 제거되었을 수 있지만, 코드가 구분해서 저장/집계하지 않음

## 실제로는 어떻게 되어야 하나?

이론적으로는:
- **충전**: < 10초인 이벤트만 제거 → 더 적게 제거 (왜냐하면 기준이 더 관대)
- **방전**: < 30초인 이벤트 제거 → 더 많이 제거 (왜냐하면 기준이 더 엄격)

하지만 데이터 특성상:
- 대부분의 짧은 이벤트가 10초 미만일 가능성이 높음
- 따라서 10초 미만인 이벤트가 대부분이고, 10~30초 사이의 이벤트는 적을 수 있음
- 이 경우 충전(< 10초)과 방전(< 30초)의 제거 개수가 비슷할 수 있음

## 코드 개선 방안

정확한 통계를 위해서는:
```matlab
% 통계 구조 수정
filterStats.(channelName).(soc_level).(profile_name).rejected_short_duration_chg = 0;
filterStats.(channelName).(soc_level).(profile_name).rejected_short_duration_dchg = 0;

% 필터링 시 구분해서 저장
if event_type > 0
    filterStats.(channelName).(soc_level).(profile_name).rejected_short_duration_chg = ...
        filterStats.(channelName).(soc_level).(profile_name).rejected_short_duration_chg + 1;
else
    filterStats.(channelName).(soc_level).(profile_name).rejected_short_duration_dchg = ...
        filterStats.(channelName).(soc_level).(profile_name).rejected_short_duration_dchg + 1;
end
```

## 현재 표의 해석

현재 표에서:
- 충전/방전 모두 "10,185개 제거"로 표시
- 이는 **코드의 한계**로 인한 것이며, 실제로는:
  - 충전: < 10초인 이벤트 제거 개수
  - 방전: < 30초인 이벤트 제거 개수
  - 두 값의 합이 10,185개일 수도 있고
  - 아니면 각각 10,185개일 수도 있음 (코드가 구분하지 않으므로 알 수 없음)

**권장사항**: 현재 표에서는 "코드가 충전/방전 구분 없이 집계함"이라고 주석을 추가하는 것이 좋습니다.
