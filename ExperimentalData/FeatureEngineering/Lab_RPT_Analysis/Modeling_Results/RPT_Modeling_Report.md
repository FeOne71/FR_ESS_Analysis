# RPT 배터리 노화 상태 추정 모델링 — 결과 보고서

> **작성일**: 2026-02-12
> **프로젝트**: KEPCO ESS 배터리 열화 진단
> **스크립트**: [RPT_Modeling.m](file:///d:/JCW/Projects/KEPCO_ESS_Local/ExperimentalData/FeatureEngineering/Lab_RPT_Analysis/RPT_Modeling.m)
> **결과 디렉토리**: `Modeling_Results/` (총 11개 .fig 파일)

---

## 1. 연구 배경 및 목적

### 1.1 연구 배경

ESS(Energy Storage System)용 리튬이온 배터리는 충·방전 사이클이 반복됨에 따라 비가역적인 열화(Degradation)가 진행된다. 열화의 주요 메커니즘은 크게 **리튬 손실(LLI, Loss of Lithium Inventory)**과 **활물질 손실(LAM, Loss of Active Material)**로 구분된다. 이 두 메커니즘의 복합적 결과로 배터리의 **잔존 가용 용량(SOH, State of Health)**이 감소하게 된다.

현장에서 배터리의 내부 열화 상태를 비파괴적으로 진단하기 위해, 주기적으로 수행하는 RPT(Reference Performance Test) 데이터에서 추출한 전기화학적 피처를 활용하여 SOH, LLI, LAM을 추정하는 데이터 기반 예측 모델을 구축한다.

### 1.2 연구 목적

1. RPT 데이터에서 추출한 14개의 C-rate 기반 전기화학 피처가 배터리 노화 상태를 얼마나 효과적으로 설명할 수 있는지 정량적으로 평가한다.
2. 선형 모델(MLR)과 비선형 모델(Random Forest)의 예측 성능을 비교하여, 피처-라벨 간 관계의 비선형성 정도를 파악한다.
3. 5-Fold Cross-Validation을 통해 모델의 일반화 성능과 안정성을 검증한다.

---

## 2. 데이터 구성

### 2.1 데이터셋 개요

본 분석에 사용된 데이터셋은 8개의 리튬이온 셀(Ch09~Ch16)에 대해 0~1000 사이클 범위에서 주기적으로 수행한 RPT 결과로부터 추출되었다. 각 RPT 시점에서 5개 C-rate(0.1C, 0.5C, 1C, 2C, 3C)에 대한 충·방전 곡선을 분석하여 피처를 생성하였으며, 모든 C-rate 데이터는 하나의 통합 피처 벡터로 결합되었다.

| 항목 | 값 | 설명 |
|---|---|---|
| **총 샘플 수** | **215개** | 유효 데이터만 포함 (NaN 제거 후) |
| **셀 수** | 8개 | Ch09, Ch10, Ch11, Ch12, Ch13, Ch14, Ch15, Ch16 |
| **입력 피처 수** | 14개 | C-rate 기반 정규화 피처 |
| **타겟 라벨 수** | 3개 | SOH, LLI, LAM |
| **C-rate** | 5종 | 0.1C, 0.5C, 1C, 2C, 3C (통합) |

### 2.2 셀별 샘플 분포

셀마다 수행된 RPT 사이클 수와 측정 조건의 차이로 인해 샘플 수가 상이하다. 특히 Ch14는 20개로 가장 적으며, 이는 해당 셀의 실험이 조기에 종료되었거나 일부 사이클 데이터가 결측된 것에 기인한다.

| 셀 | Ch09 | Ch10 | Ch11 | Ch12 | Ch13 | Ch14 | Ch15 | Ch16 | **합계** |
|---|---|---|---|---|---|---|---|---|---|
| **샘플 수** | 30 | 30 | 30 | 25 | 30 | 20 | 25 | 25 | **215** |
| **비율(%)** | 14.0 | 14.0 | 14.0 | 11.6 | 14.0 | 9.3 | 11.6 | 11.6 | 100 |

### 2.3 입력 피처 상세 (14개)

모든 피처는 C-rate별로 정규화(`X_Normalized`)되어 있으며, C-rate에 따른 스케일 차이가 제거된 상태이다. 피처는 크게 세 범주로 분류된다.

#### 범주 1: 구간별 충전 용량 (5개)

| 피처명 | 정의 | 물리적 의미 |
|---|---|---|
| **Chg_dQ1** | 충전 V-Q 곡선의 1번째 전압 구간 ΔQ | 저전압 영역의 충전 용량. 그래파이트 음극의 초기 리튬 삽입 단계 반영 |
| **Chg_dQ2** | 2번째 전압 구간 ΔQ | 음극 Phase I→II 전이 영역의 용량 |
| **Chg_dQ3** | 3번째 전압 구간 ΔQ | 중간 전압 영역. 주 반응 구간 |
| **Chg_dQ4** | 4번째 전압 구간 ΔQ | 고전압 영역 초입의 용량 |
| **Chg_dQ5** | 5번째 전압 구간 ΔQ | 최고 전압 영역. 양극 구조 변화에 민감 |

#### 범주 2: 구간별 방전 용량 (5개)

| 피처명 | 정의 | 물리적 의미 |
|---|---|---|
| **Dch_dQ1 ~ Dch_dQ5** | 방전 V-Q 곡선의 5개 전압 구간별 ΔQ | 충전과 대칭적 구조. 방전 시 각 전압 영역에서 추출 가능한 용량을 반영 |

#### 범주 3: dQ/dV 피크 특성 (4개)

| 피처명 | 정의 | 물리적 의미 |
|---|---|---|
| **Chg_PkH** | 충전 dQ/dV 메인 피크 높이 | 주 전기화학 반응의 활성도. 활물질 감소 시 피크 높이 감소 |
| **Chg_PkA** | 충전 dQ/dV 메인 피크 면적 | 해당 전압 영역에서의 총 반응량. 피크 폭의 변화도 반영 |
| **Dch_PkH** | 방전 dQ/dV 메인 피크 높이 | 방전 시 주 반응의 활성도 |
| **Dch_PkA** | 방전 dQ/dV 메인 피크 면적 | 방전 시 해당 영역의 총 반응량 |

### 2.4 타겟 라벨 상세 (3개)

라벨은 **OCV(Open Circuit Voltage) Charge** 데이터의 dQ/dV 분석으로부터 생성되었다. OCV는 C-rate의 영향을 받지 않는 열역학적 평형 상태의 전압이므로, 내부 열화 메커니즘을 가장 순수하게 반영한다.

| 라벨 | 정식 명칭 | 정의 | 단위 | 변동 범위 (대략) | 물리적 의미 |
|---|---|---|---|---|---|
| **SOH** | State of Health | RPT 가용 용량 | **Ah** | ~85 → ~75 Ah | 배터리가 저장·방출할 수 있는 총 에너지 |
| **LLI** | Loss of Lithium Inventory | OCV dQ/dV 메인 피크 전압의 Cycle 0 대비 시프트 | **V** | ~0 → ~0.01 V | SEI 성장 등에 의한 활성 리튬 소모로 전극 전위 플랫폼 이동 |
| **LAM** | Loss of Active Material | OCV dQ/dV 메인 피크 높이의 Cycle 0 대비 변화 | **Ah/V** | ~0 → ~-30 Ah/V | 양극/음극 활물질 구조 손상으로 전기화학 반응 면적 감소 |

> [!NOTE]
> LLI의 변동 범위가 약 0.01V로 극히 작다는 점은 이후 모델링 결과 해석에서 중요한 맥락을 제공한다. 이 정도 크기의 변화는 측정 노이즈 수준에 근접하며, 셀 간 개체차에 의해 쉽게 묻힐 수 있다.

---

## 3. 방법론

본 분석의 전체 파이프라인은 **차원 축소(PCA) → Sanity Check(MLR) → 교차 검증(5-Fold CV)**의 3단계로 구성된다.

### 3.1 차원 축소: PCA (Principal Component Analysis)

#### 적용 목적

14개 피처 간에는 강한 다중공선성(Multicollinearity)이 존재한다. 예를 들어, 같은 C-rate의 충전 구간 ΔQ들은 서로 상관관계가 높으며, 충전과 방전의 대칭적 피처들도 유사하게 변한다. PCA를 적용하여:
- 다중공선성을 해소하고
- 피처 공간의 노이즈를 줄이며
- 노화 정보를 최소 차원에 압축한다.

#### 결과

누적 설명력 **95%** 이상을 기준으로 주성분 개수를 결정하였다.

| 주성분 | 개별 설명력 (%) | 누적 설명력 (%) | 해석 |
|---|---|---|---|
| **PC1** | **78.41** | 78.41 | **노화 공통 인자**. 14개 피처가 함께 변하는 주된 방향 |
| **PC2** | 7.61 | 86.02 | 충전/방전 간 비대칭적 변화 방향 |
| **PC3** | 4.13 | 90.15 | 피크 특성 vs 구간 용량의 잔여 차이 |
| **PC4** | 3.76 | 93.91 | 고전압/저전압 영역 간 차등 변화 |
| **PC5** | 2.89 | **96.79** | 미세 변동 (노이즈 경계) |
| PC6~14 | 3.21 (합계) | 100 | — 제거됨 |

**14개 → 5개 PC**로 차원이 축소되었다 (약 64% 감소).

> [!IMPORTANT]
> **PC1이 78.41%를 단독 설명**한다는 것은, 14개 피처의 변동 대부분이 **"배터리 노화"라는 단일 물리 현상**에 의해 지배됨을 의미한다. 이는 PCA 적용의 물리적 타당성을 강력히 뒷받침하며, 동시에 이 데이터에서 추출할 수 있는 **독립적 정보의 차원이 제한적**임을 시사한다.

### 3.2 모델 구성

#### 3.2.1 MLR (Multiple Linear Regression, 다중선형회귀)

$$\hat{y} = \beta_0 + \beta_1 \cdot PC_1 + \beta_2 \cdot PC_2 + \cdots + \beta_5 \cdot PC_5$$

- MATLAB `fitlm` 함수를 사용하여 최소자승법(OLS)으로 계수를 추정한다.
- 하이퍼파라미터가 없어 별도 튜닝이 불필요하다.
- 피처-라벨 간 관계가 선형적일 때 최적의 해석력을 제공한다.
- **역할**: 비선형 모델(RF)과의 비교 기준선(Baseline).

#### 3.2.2 RF (Random Forest, 랜덤 포레스트)

- MATLAB `fitrensemble`(Bagging 방식)으로 구현하였다.
- 다수의 결정 트리(Decision Tree)를 독립적으로 학습시킨 후 예측값의 **평균**을 최종 예측으로 사용한다.
- 각 트리는 Bootstrap 샘플링된 데이터로 학습하며, 미사용 샘플(Out-of-Bag, OOB)로 내부 검증이 가능하다.
- **비선형 관계 포착 능력**이 핵심 장점이며, 피처 간 상호작용도 자동으로 반영한다.

#### 3.2.3 RF 하이퍼파라미터 탐색

각 Fold, 각 라벨에 대해 아래 그리드의 **16개 조합**을 모두 평가한다.

| 파라미터 | 탐색 값 | 역할 |
|---|---|---|
| **NumLearningCycles** (나무 개수) | 50, 100, 200, 500 | 앙상블 크기. 클수록 분산 감소, 계산 비용 증가 |
| **MinLeafSize** (최소 잎 크기) | 1, 3, 5, 10 | 트리 복잡도 제어. 작을수록 복잡한 패턴 학습, 과적합 위험 증가 |

최적 조합 선정 기준은 **OOB RMSE**(Out-of-Bag Root Mean Square Error)이다. OOB Error는 각 트리가 학습에 사용하지 않은 약 37%의 데이터로 계산되므로, 별도의 검증 세트 없이도 과적합 정도를 추정할 수 있다.

### 3.3 검증 프로토콜: 5-Fold Cross-Validation

#### 설계

8개 셀의 215개 샘플을 **셀 구분 없이 랜덤 셔플**하여 5등분한다 (시드 42 고정으로 재현성 보장). 각 Fold에서 약 172개를 Train, 43개를 Test로 사용한다.

#### Data Leakage 방지

각 Fold에서 독립적으로 다음을 수행하여 Test 세트의 정보가 모델 학습에 유입되는 것을 방지한다:

| 단계 | 처리 내용 | Data Leakage 방지 조치 |
|---|---|---|
| **Z-score 정규화** | $X_{norm} = \frac{X - \mu_{train}}{\sigma_{train}}$ | Train의 μ, σ만 사용. Test도 Train 통계량으로 정규화 |
| **PCA 축 정의** | Train 데이터로 PCA 수행 → 고유벡터(coeff) 산출 | Test는 Train의 축에 투영만 수행 (`X_test * coeff`) |
| **모델 학습** | Train으로만 MLR/RF 학습 | Test 데이터는 학습에 미사용 |

#### 평가 지표

| 지표 | 수식 | 의미 |
|---|---|---|
| **RMSE** | $\sqrt{\frac{1}{n}\sum(y_i - \hat{y}_i)^2}$ | 큰 오차에 가중치. 단위 = 라벨 단위 |
| **MAE** | $\frac{1}{n}\sum\lvert y_i - \hat{y}_i \rvert$ | 평균적 절대 오차. 단위 = 라벨 단위 |
| **R²** | $1 - \frac{\sum(y_i - \hat{y}_i)^2}{\sum(y_i - \bar{y})^2}$ | 1에 가까울수록 우수. 0 = 평균 수준, 음수 = 평균보다 못함 |

---

## 4. 결과

### 4.1 단계 1: Sanity Check (전체 데이터 MLR)

피처가 라벨을 설명할 수 있는 기본적인 능력을 확인하기 위해, **Train = Test** 조건(전체 215개 샘플)에서 MLR을 학습하였다. 이 조건에서는 과적합이 허용 되므로, R²가 높게 나오는 것이 기대된다. 만약 이 조건에서도 R²가 낮다면 피처 자체에 라벨 정보가 부족한 것으로 판단할 수 있다.

| 라벨 | R² | Adjusted R² | 판정 | 해석 |
|---|---|---|---|---|
| **SOH** | **0.8653** | 0.8621 | ✅ 우수 | 5개 PC만으로 SOH 분산의 86.5%를 설명. 강한 선형 관계 확인 |
| **LAM** | 0.6703 | 0.6624 | ⚠️ 보통 | 선형으로 67% 설명. 비선형 성분이 존재함을 시사 |
| **LLI** | 0.2883 | 0.2712 | ❌ 제한적 | 선형으로는 29%만 설명. 변동 범위 극소(~0.01V)에 기인 |

> Sanity Check에서 SOH의 R² = 0.87은, C-rate 기반 dQ 피처가 배터리 가용 용량과 **매우 강한 선형 상관관계**를 가지고 있음을 의미한다. 반면 LLI의 R² = 0.29는 피처로 인한 한계보다는 **라벨 자체의 변동 범위가 극히 작아** 노이즈 대비 신호가 약한 것에 기인한다.

### 4.2 단계 2: 5-Fold Cross-Validation 결과

#### 4.2.1 SOH (Available Capacity, 단위: Ah)

SOH는 배터리의 가장 직관적인 성능 지표로, 모든 Fold에서 안정적으로 높은 R²를 기록하였다.

| Fold | Train / Test | MLR RMSE (Ah) | MLR MAE (Ah) | MLR R² | RF RMSE (Ah) | RF MAE (Ah) | RF R² | RF 최적 HP |
|---|---|---|---|---|---|---|---|---|
| 1 | 172 / 43 | 0.9646 | 0.7434 | 0.8207 | 0.9537 | 0.6474 | 0.8248 | Trees=500, Leaf=1 |
| 2 | 172 / 43 | 0.7446 | 0.6442 | 0.8661 | 0.9102 | 0.6913 | 0.8000 | Trees=50, Leaf=1 |
| 3 | 172 / 43 | 0.8694 | 0.7448 | 0.8517 | 0.9598 | 0.7363 | 0.8193 | Trees=200, Leaf=1 |
| 4 | 172 / 43 | 0.7356 | 0.5979 | 0.8724 | 0.8052 | 0.6142 | 0.8471 | Trees=200, Leaf=1 |
| 5 | 172 / 43 | 0.8220 | 0.6468 | 0.8336 | 0.7198 | 0.5710 | **0.8724** | Trees=500, Leaf=1 |
| **Mean** | | **0.827** | **0.675** | **0.849** | **0.870** | **0.652** | **0.833** | |
| **Std** | | ±0.095 | ±0.066 | ±0.022 | ±0.104 | ±0.065 | ±0.028 | |

**분석:**
- MLR의 평균 R²(0.849)가 RF(0.833)보다 약간 높다. 이는 SOH와 PC 간 관계가 **이미 충분히 선형적**이어서, RF의 비선형 학습이 추가적 이점을 제공하지 못함을 의미한다.
- RF의 MAE(0.652 Ah)이 MLR(0.675 Ah)보다 소폭 낮아, 중앙 경향의 예측에서는 RF가 약간 우위이다.
- 모든 Fold에서 R² > 0.80을 유지하며, **표준편차가 0.022~0.028로 매우 낮아 모델이 안정적**이다.
- 최적 HP는 대부분 **MinLeafSize=1** (최대 복잡도)로 수렴하였으며, 나무 개수는 Fold에 따라 50~500까지 다양하였다.

#### 4.2.2 LLI (Peak Voltage Shift, 단위: V)

LLI는 OCV dQ/dV 피크 전압의 미세 시프트(~0.01V)를 추정하는 과제이다.

| Fold | MLR RMSE (V) | MLR MAE (V) | MLR R² | RF RMSE (V) | RF MAE (V) | RF R² |
|---|---|---|---|---|---|---|
| 1 | 0.0034 | 0.0026 | 0.109 | 0.0026 | 0.0019 | 0.466 |
| 2 | 0.0022 | 0.0017 | 0.336 | 0.0016 | 0.0011 | **0.656** |
| 3 | 0.0027 | 0.0019 | 0.207 | 0.0027 | 0.0019 | 0.211 |
| 4 | 0.0027 | 0.0022 | 0.132 | 0.0019 | 0.0015 | 0.544 |
| 5 | 0.0022 | 0.0016 | 0.120 | 0.0018 | 0.0013 | 0.432 |
| **Mean** | **0.0026** | **0.0020** | **0.181** | **0.0021** | **0.0015** | **0.462** |
| **Std** | ±0.0005 | ±0.0004 | ±0.095 | ±0.0005 | ±0.0004 | ±0.164 |

**분석:**
- RF가 MLR 대비 R²를 **0.181 → 0.462**로 약 **+28.1%p 개선**하였다. 이는 LLI와 PC 간 관계에 유의미한 **비선형 성분**이 존재함을 의미한다.
- RF RMSE 평균 0.0021V는 LLI 전체 변동 범위(~0.01V)의 약 **21%**에 해당한다. 다시 말해, 예측 오차가 신호 자체의 1/5 수준이므로 실용적 활용에는 한계가 있다.
- Fold 간 R² 표준편차가 ±0.164으로 상대적으로 높아, **데이터 분할에 따른 성능 변동이 큰 편**이다. Fold 2에서는 R²=0.656까지 도달한 반면, Fold 3에서는 0.211에 그쳤다.
- 이러한 불안정성은 LLI 변동 범위 자체가 ~0.01V로 극히 작아, Fold에 따라 Test 세트의 LLI 분포가 크게 달라질 수 있기 때문이다.

#### 4.2.3 LAM (Peak Height Change, 단위: Ah/V)

LAM은 OCV dQ/dV 피크 높이의 변화량으로, 활물질 손실 정도를 반영한다.

| Fold | MLR RMSE (Ah/V) | MLR MAE (Ah/V) | MLR R² | RF RMSE (Ah/V) | RF MAE (Ah/V) | RF R² |
|---|---|---|---|---|---|---|
| 1 | 11.044 | 8.536 | 0.575 | 9.836 | 6.579 | 0.663 |
| 2 | 7.117 | 6.057 | 0.746 | 7.622 | 5.467 | 0.708 |
| 3 | 10.060 | 8.303 | 0.600 | 10.345 | 7.654 | 0.577 |
| 4 | 8.078 | 6.747 | 0.660 | 6.817 | 5.027 | **0.758** |
| 5 | 9.211 | 7.380 | 0.527 | 7.617 | 5.889 | 0.676 |
| **Mean** | **9.102** | **7.405** | **0.621** | **8.448** | **6.123** | **0.676** |
| **Std** | ±1.557 | ±1.041 | ±0.084 | ±1.546 | ±1.029 | ±0.067 |

**분석:**
- RF가 MLR 대비 R²를 **0.621 → 0.676**으로 **+5.5%p 개선**하였다. RMSE도 9.102 → 8.448 Ah/V로 7.2% 감소하였다.
- 모든 Fold에서 RF의 MAE가 MLR보다 낮아, **중앙 경향의 예측 정확도가 일관되게 개선**되었다.
- R² 표준편차는 ±0.067로 SOH(±0.028)보다는 크지만 LLI(±0.164)보다는 작아, 적당한 안정성을 보인다.
- Fold 4에서 R²=0.758로 최고 성능을 기록하였으며, Fold 3에서는 0.577로 가장 낮았다. 이는 해당 Fold의 Test 세트에 포함된 셀의 LAM 변동 패턴에 따른 차이이다.

---

## 5. 종합 분석

### 5.1 MLR vs RF 성능 요약

| 라벨 | MLR Mean R² | RF Mean R² | R² 개선 (%p) | MLR Mean RMSE | RF Mean RMSE | RMSE 개선 (%) | 우위 모델 |
|---|---|---|---|---|---|---|---|
| **SOH** | **0.849** | 0.833 | -1.6 | **0.827 Ah** | 0.870 Ah | -5.2 | MLR |
| **LLI** | 0.181 | **0.462** | **+28.1** | 0.0026 V | **0.0021 V** | +19.2 | **RF** |
| **LAM** | 0.621 | **0.676** | **+5.5** | 9.102 Ah/V | **8.448 Ah/V** | +7.2 | **RF** |

### 5.2 물리적 해석

#### SOH (R² = 0.83~0.85)
C-rate 기반 구간 용량(ΔQ) 피처는 배터리의 총 가용 용량과 **직접적인 물리적 인과관계**를 가진다. 배터리 용량이 줄어들면 각 전압 구간에서 추출 가능한 용량(ΔQ)도 비례적으로 감소하기 때문이다. 이 강한 선형성으로 인해 MLR만으로도 R² = 0.85에 도달하며, RF의 비선형 학습이 추가적 이점을 제공하지 못한다.

#### LLI (R² = 0.46)
리튬 손실에 의한 전압 피크 시프트는 ~0.01V 수준으로, C-rate 기반 dQ 피처와의 **간접적**인 관계만 존재한다. 리튬이 소모되면 전극 전위가 미세하게 이동하고, 이것이 dQ 분포에 2차적으로 영향을 주지만, 그 효과의 크기가 작다. RF가 이 미세한 비선형 맵핑을 부분적으로 포착하여 R²를 0.18 → 0.46으로 개선하였으나, 신호 자체의 SNR(Signal-to-Noise Ratio)이 낮아 근본적 한계가 존재한다.

#### LAM (R² = 0.68)
활물질 손실은 dQ/dV 피크 높이 감소로 직접 관측되며, 동시에 구간 ΔQ의 비균일적 감소로도 나타난다. dQ/dV 피크 특성 피처(PkH, PkA)와 구간 ΔQ 피처 모두가 LAM 정보를 담고 있으나, 이들의 조합이 비선형적이어서 RF가 MLR보다 우수한 성능을 보인다.

### 5.3 모델 안정성 분석

| 지표 | SOH | LLI | LAM | 판정 기준 |
|---|---|---|---|---|
| **RF R² Std** | ±0.028 | ±0.164 | ±0.067 | <0.05: 우수, <0.10: 양호, ≥0.10: 주의 |
| **RF RMSE Std** | ±0.104 Ah | ±0.0005 V | ±1.546 Ah/V | — |
| **판정** | ✅ 매우 안정 | ⚠️ 불안정 | ✅ 양호 | — |

LLI의 불안정성(R² Std=±0.164)은 **라벨 변동 범위가 극소**하여, Fold별 Test 세트의 LLI 분포 차이가 R²에 큰 영향을 미치기 때문이다. 이는 모델의 문제라기보다 **문제 자체의 어려움**을 반영한다.

---

## 6. 생성된 시각화 파일 상세 (11개)

모든 파일은 `Modeling_Results/` 디렉토리에 MATLAB .fig 형식으로 저장되었다.

### 6.1 분석용 (5개)

| # | 파일명 | 차트 유형 | 내용 상세 | 확인 사항 |
|---|---|---|---|---|
| 1 | `PCA_Scree_Plot.fig` | Bar + Line (2-panel) | 좌: 14개 PC의 개별 설명력 막대 (선택된 5개 강조), 우: 누적 설명력 곡선 + 95% 기준선 + PC5 교차점 표시 | PC 개수 선정 기준의 시각적 근거 |
| 2 | `MLR_Sanity_Check.fig` | Scatter (3-panel) | SOH/LLI/LAM 각각의 Predicted vs Actual 산점도. 8개 셀이 서로 다른 색상으로 구분. 45° 기준선 포함 | 피처-라벨 관계의 존재 확인. 점들이 45° 선에 밀집할수록 설명력 우수 |
| 3 | `RF_Feature_Importance.fig` | Horizontal Bar (3-panel) | SOH/LLI/LAM 각각에 대한 14개 원본 피처의 RF 기여도. 내림차순 정렬 | 어떤 피처가 각 라벨 예측에 결정적인지 확인 |
| 4 | `RF_Error_Distribution.fig` | Histogram (3-panel) | SOH/LLI/LAM 각각의 RF 예측 오차 분포. 0 기준선, Mean, Std 표시 | 오차 분포가 0 중심 정규분포에 가까운지 (편향 부재) 확인 |
| 5 | `RF_Residual_Plot.fig` | Scatter (3-panel) | X축: Actual, Y축: Residual(Pred-Actual). ±1σ 밴드 표시, Bias 수치 기재 | 특정 영역에 오차가 집중되는지 (Heteroscedasticity) 확인 |

### 6.2 PPT 요약용 (4개)

| # | 파일명 | 차트 유형 | 내용 상세 |
|---|---|---|---|
| 6 | `KFold_RF_Predicted_vs_Actual.fig` | Scatter (3-panel) | 5-Fold 전체 데이터의 RF Predicted vs Actual. 전체 R² 표시 |
| 7 | `MLR_vs_RF_SOH_Comparison.fig` | Grouped Bar | Fold별 SOH RMSE 비교 (MLR 파랑, RF 주황). 각 모델의 평균 RMSE 수평선 표시 |
| 8 | `Overall_Label_Comparison.fig` | Bar (3-panel) | SOH/LLI/LAM 각각의 MLR vs RF 평균 RMSE. 수치 표시 |
| 9 | `MLR_vs_RF_R2_Comparison.fig` | Grouped Bar | 라벨별 MLR과 RF의 평균 R² 비교. 각 막대 위에 수치, 중앙에 개선량(%p) 녹색 표시 |

### 6.3 프로세스 증명용 (2개)

| # | 파일명 | 차트 유형 | 내용 상세 |
|---|---|---|---|
| 10 | `HP_Tuning_Heatmap.fig` | Heatmap | 4×4 그리드(NumTrees × MinLeafSize)에서의 SOH OOB RMSE. 최적점에 ○ 마커와 수치, 모든 셀에 RMSE 수치 표시. "체계적 HP 최적화가 수행되었음"을 증명 |
| 11 | `SOH_Trace_Per_Cell.fig` | Line (8-panel) | **8개 셀 전체**의 Sample Index별 SOH 트레이스. 검정 실선(Actual) 위에 파란 MLR 예측과 빨간 RF 예측을 점으로 표시. 셀별 R² 기재. "각 셀에서 모델이 노화 트렌드를 얼마나 잘 추종하는지" 시각적 확인 |

---

## 7. 결론

1. **SOH 추정 성능이 우수하다.** 5-Fold CV에서 MLR R² = 0.849, RF R² = 0.833으로, 두 모델 모두 가용 용량의 83~85%를 설명한다. R² 표준편차가 ±0.022~0.028로 Fold 간 안정성도 높다. C-rate 기반 dQ 피처가 SOH와 강한 선형 관계를 가지므로 단순 선형 모델(MLR)만으로도 충분한 성능을 보인다.

2. **LLI 추정은 RF에서 유의미하게 개선되었으나 절대적 한계가 존재한다.** MLR R² = 0.181에서 RF R² = 0.462로 +28.1%p 개선되어 비선형 모델의 우위가 확인되었다. 그러나 LLI 변동 범위 자체가 ~0.01V로 측정 노이즈 수준에 근접하여, R²의 Fold 간 표준편차(±0.164)가 크고 절대적 예측 정밀도에 한계가 있다.

3. **LAM 추정은 양호한 수준이다.** RF R² = 0.676 ± 0.067로, 활물질 손실의 약 68%를 설명한다. dQ/dV 피크 특성 피처와 구간 ΔQ 피처의 조합이 LAM 정보를 비선형적으로 담고 있음을 확인하였다.

4. **RF의 비선형 학습 능력은 LLI와 LAM에서 유효하다.** SOH는 이미 선형적이므로 RF가 MLR을 초과하지 못하지만, LLI(+28.1%p)와 LAM(+5.5%p)에서는 RF가 비선형 패턴을 포착하여 성능이 개선되었다.

---

## 8. 향후 개선 방향

| 방향 | 세부 내용 | 기대 효과 |
|---|---|---|
| **LLI/LAM용 피처 보강** | OCV dQ/dV 피크 전압과 피크 높이를 입력 피처로 직접 추가. 현재 라벨과 동일한 원천에서 유래하므로 직접적 설명력 기대 | LLI/LAM R² 향상 |
| **딥러닝 모델 적용** | ICA(dQ/dV) 곡선 전체를 CNN 또는 LSTM의 입력으로 활용. 곡선 형상의 미세 변화를 학습 | 수작업 피처 추출의 정보 손실 최소화 |
| **데이터 확장** | Ch14(20개) 등 소수 샘플 셀의 추가 RPT 사이클 확보. 1000 사이클 이후 데이터 추가 | Fold 간 편차 감소, 장기 열화 예측 |
| **추가 모델 비교** | Gradient Boosting (XGBoost), SVR(Support Vector Regression), GPR(Gaussian Process Regression) | 최적 모델 아키텍처 탐색 |
| **셀 간 일반화 검증** | Leave-One-Cell-Out CV를 별도 수행하여 신규 배터리 투입 시나리오의 성능 평가 | 실소 배포 가능성 검증 |
